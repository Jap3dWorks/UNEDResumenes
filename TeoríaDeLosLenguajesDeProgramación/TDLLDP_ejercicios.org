#+title: Teoría de los lenguajes de programación Ejercicios
#+autor: Jordi Amposta Perez

* Programación funcional Haskel
** Org Babel Usage
#+name: haskell-compile-hello-world
#+begin_src haskell :compile yes :results output
main :: IO ()
main = putStrLn  "Hello world!"
#+end_src

#+RESULTS: haskell-compile-hello-world
: Hello world!

#+name: haskell-interpret-hello-world
#+begin_src haskell
print "Hello world!"
#+end_src

#+RESULTS: haskell-interpret-hello-world

** Número polidivisible
- Un número es polidivisible si es divisible por si longitud, y además al eliminar la cifra de las unidades vuelve a ser polidivisible.

#+begin_src haskell :compile yes :results output
main :: IO()
  
polidivisible n
  | n <= 0 = False
  | otherwise = ipolidivisible n (long n)
  where
    ipolidivisible _ 1 = True
    ipolidivisible n l = ((mod n l) == 0) && (ipolidivisible (div n 10) (l-1))
    long n
      | n < 10 = 1
      | otherwise = 1 + long (div n 10)


main = putStrLn("Result: " ++ show(polidivisible 1024))
#+end_src

#+RESULTS:
: Result: True

** Reglas de reescritura
- pag 79

#+begin_src haskell :compile yes :results output
main :: IO()

reescribe cad [] = []
reescribe cad ((ent,sal):resto)
  | cad == ent = sal
  | otherwise  = reescribe cad resto

-- r: reglas  
reescritura r [] = []
reescritura r (cad:resto)
  | salida == [] = cad:(reescritura r resto)        -- cad no está dentro de reglas
  | otherwise    = reescritura r (salida ++ resto)  -- salida tiene la traducción
                                                    --  Así si si hay una cadena que se puede
                                                    --  expandir de nuevo esta se expande.
  where
    salida = reescribe cad r

reglas = [("DESPEDIDA", ["ADIOS", "NOS VEMOS"]),
          ("HOLA", ["ENCANTADO"]),
          ("SALUDO", ["HOLA", "QUE TAL?"])]

main = putStrLn(show(reescritura reglas ["SALUDO", "SOY UN PROGRAMA", "DESPEDIDA"]))
#+end_src

#+RESULTS:
: ["ENCANTADO","QUE TAL?","SOY UN PROGRAMA","ADIOS","NOS VEMOS"]

** Números expansivos
- pag 79
  
