#+title: RedesDeComputadores
#+author: Jordi Amposta Pérez
#+startup: latexpreview overview

* Introducción
** Transmisión de datos
*** Componentes
- Mensaje
- Emisor
- Receptor
- Medio
- Protocolo

*** Flujo de datos
- *Simplex*, comunicación unidireccional.
- *Semidúplex*, Bidireccional pero no al mismo tiempo.
- *Full-dúplex*, Bidireccional simultáneamente.

** Redes
*** Criterios a satisfacer 
- *Rendimiento*, tiempo de tránsito y de respuesta.
      - Se suelen usar dos métricas
            - Tasa de transferencia efectiva
            - Latencia
- *Fiabilidad*, exactitud de la entrega.
- *Seguridad*, protección frente accesos no autorizados.
        
*** Estructuras físicas
- *Tipo de conexión*.
      - *Punto a punto*, enlace dedicado entre dos puntos.
            - La mayoría usan cables.
      - *Multipunto*, varios dispositivos comparten el mismo enlace (y la capacidad del canal).
            - *compartida especialmente*, varios dispositivos pueden usar el enlace de forma simultánea.
            - *tiempo compartido*, Los usuarios comparten la línea por turnos.

- *Topología Física*.
      - Forma física en la que está diseñada la red.
      - *Topología en malla*, Cada dispositivo tiene un enlace punto a punto con cualquier otro dispositivo.
            - $N_{con} = \frac{n(n-1)}{2}$

      - *Topología en estrella*.
            - Cada dispositivo tiene un enlace punto a punto con el concentrador cental (hub).
                  - concentrador o conmutador (conmutador es mejor).
            - Más barata que la tolopología en malla.
            - Es una topología robusta.
                  - Ante cualquier error puede usarse el concentrador como monitor.
            - Muy usada en redes LAN.

      - *Topolgía de bus*.
            - Conexión multipunto.
            - Todos los dispositivos se conectan a un cable troncal(bus).
            - Los dispositivos se conectan usando sondas o latiguillos.
            - En el bus parte de la energía se disipa en forma de calor.
                  - Hay un límite en la longitud del cable troncal.
                  - Hay límite en la candidad de conexiones al bus.
            - Todos los dispositivos pueden leer el bus, no asegura la privacidad.
            - Es de instalación sencilla.
            - Es dificil aislar los fallos.
            - Es difici añadir nuevos dispositivos a la red una vez el bus se ha diseñado e instalado.
            - Un fallo o rotura en el bus puede desconectar toda la red.

      - *Topología en anillo*.
            - Cada dispositivo tiene una conexión punto a punto
              con los otros dos dispositivos que están a sus lados.
            - Cada dispositivo del anillo implementa un repetidor.
            - Es fácil detectar y aislar fallos.
            - Puede ser frágil si falla un nodo de la red.

*** Tipos Redes
**** LAN
- Local Area Network
- Conecta hosts de una única oficina, edifiio o campus.
- Cada host de la lan tiene un identificador (ipv4).
- Actualmente los hosts se conectan usando un conmutador (switch) (topología de estrella).
      - Antiguamente se usaba un bus.

**** WAN
- Wide Area Network
- Alcance geográfico más extenso, una ciudad, un estado, un país o incluso el mundo.
- Conecta dispositivos de conexión como conmutadores, enrutadores o modems.
- Dos tipos de WAN
      - *WAN punto a punto*, Conecta dos dispositivos de comunicación a través de un medio.
      - *WAN conmutada*.
            - Red con más de dos extremos.
            - Varias Wan punto a punto conectadas por conmutadores.
            - Vertebra la conmunicación actual.
- *interred* o *internet*, dos o más redes conectadas (WAN o LAN).
      - Internet son muchas redes conmutadas.

*** Internet
- Es la red de redes más notable, Internet con I.
- Es una colaboración de cientos de miles de redes interconectadas.
- Acceso a Internet
      - *Usando redes telefónicas*
            - Servicio marcación
            - Servicio DSL
      - *Usando cables de Red*
      - *Usando redes inalámbricas*
      - *Conexión directa a internet*

*** Historia de Internet
- *ARPANET*, 

*** Normas y Administración de Internet
- *Borrador* draft, documento de trabajo sin estatus.
- *RFC*, request for comments, bajo recomendación de las autoridades un borrador se puede publicar como rfc.
- Niveles de madurez de un RFC
      - *Norma Propuesta*
      - *Proyecto estandar*
      - *Estándar de Internet*
      - *Histórico*
      - *Experimental*
      - *Informativo*
- Niveles de requerimientos
      - *Requerido*
      - *Recomendado*
      - *Optativo*
      - *De uso limitado*
      - *No recomendado*

*** Administraión de Internet
- *ISOC*, Internet society, presta apoyo al proceso de creación de normas de internet.
- *IAB*, Junta de arquitectura de internet, Asesor técnico de la ISOC.
      - Supervisa el desarrollo de los protocolos ISP/IP.
- *IETF*, Grupo de trabajo de ingeniería de Internet, Internet Engineering Task Force.
      - Responsable de encontrar problemas operacionales y recomendar soluciones.
- *IRTF*, Internet Research Task Force.
      - Se centra en encontrar soluciones a largo plazo.

* Modelos de Red
** Principios de la arquitectura por niveles
- *Primer Principio*, Cada nivel debe realizar dos tareas opuestas.
  Por ejemplo escuchar en una direccióny hablar en la otra.
- *Segundo Principio*, Los dos objetos en cada nivel en ambos sitios deben ser idénticos.

** Protocolos TCP/IP
*** Capas y mensajes

| capa            | paquete                         | cabeceras                               | Direccionamiento                     |
|-----------------+---------------------------------+-----------------------------------------+--------------------------------------|
| Aplicación      | Mensaje                         | [mensaje]                               | Nombres                              |
| Transporte      | segmento / datagrama de usuario | [c.trasporte][mensaje]                  | Número de puerto                     |
| Red             | datagrama de red                | [c.red][c.transporte][mensaje]          | Direcciones lógicas (IP)             |
| Enlace de Datos | trama                           | [c.datos][c.red][c.transporte][mensaje] | Direcciones de nivel de enlace (MAC) |
| Físico          | bits                            | --                                      | --                                   |

*** Multiplexación y demultiplexación
- *Multiplexación*, Un protocolo de un nivel puede encapsular varios protocolos del nivel superior.
      - ftp y http se encapsulan en tcp.
- *Demultiplexación*, Un protocolo puede desencapsular y entregar paquetes a varios protocolos de nivel superior.
      - IP puede entregar a TCP y UDP

** Modelo OSI
- OSI es un modelo para entender y diseñar una arquitectura de red que sea flexible, robusta e interoperable.
- ISO es la organización, OSI es el modelo.
- Careció de éxito.
- Niveles
  | capa            | relativo tcp/ip |
  |-----------------+-----------------|
  | Aplicación      | Aplicación      |
  | Presentación    | Aplicación      |
  | Sesión          | Aplicación      |
  | Transporte      | Transporte      |
  | Red             | Red             |
  | Enlace de datos | Enlace de datos |
  | Físico          | Físico          |

* Nivel físico
- Paquete: bits
- Transporta los bits individuales del nivel de enlace.
      - Señales electromagnéticas.

** Datos y señales
- *Datos analógicos*, la información es continua.
- *Datos digitales*, la información es discreta.
- *Señal periódica*, completa una pauta dentro de un marco temporal mesurable.
- *Señal no periódica*, cambia sin exhibir un patrón o ciclo.

** Señales periódicas analógicas
*** Señal simple
- *señal simple*, una onda seno.
- *Amplitud pico*, valor absoluto de su mayor intensidad.
- *Periodo*, cantidad de segundos en completar un ciclo.
      - $T = \frac{1}{f}$
      - Unidad segundos $s$
- *Frecuencia*, número de periodos en 1 segundo.
      - $f = \frac{1}{T}$
      - Unidad Herzios $Hz$.
      - Si una señal no cambia nunca su frecuencia es $0 Hz$.
      - Si una señal cambia instantáneamente su frecuecnia es $\infty Hz$

- *Fase* o desplazamiento de fase, describe la posición de la forma de la onda en el tiempo 0.
      - Unidad: grados o radianes.

- *Longitud de onda*, vincula el periodo o frecuencia con *velocidad de propagación*.
      - La longitud de onda depende del medio (medios con mayor o menos velocidad de propagación).
      - $\lambda = c \cdot T = \frac{c}{f}$
            - $\lambda$, longitud de onda.
            - $c$, velocidad de propagación.
            - $T$, Periodo.
            - $f$, frecuencia.

*** Señal compuesta
- *Señal compuesta*, compuesta por múltiples onda seno.
- Según el analisis de Fourier, cualquier señal compuesta esuna combinación de ondas senoidales simples
  con diferentes frecuencias, amplitudes y fases.
- Una señal compuesta periódica puede descomponerse en un número finito de ondas seno
  con frecuencia discreta, números naturales.
- Una señal compuesta no periódica está compuesta de infinitas ondas seno simple,
  con frecuencias de valor real.
- *Frecuencia fundamental o Primer armónico*, onda seno simple con la misma frecuencia $f$ que la señal compuesta.
      - *segundo, tercer, ... armónico*: $a \cdot f\ | \ a \in \mathbb{N},\ a > 1$.
        
*** Ancho de banda
- *Ancho de banda*, Rango de frecuencias que contiene una señal compuesta.
      - $[f_{min}, f_{max}] \to B = f_{max} - f_{min} \ Hz$
            - $B$, el ancho de banda.
            - $f_{min}$, frecuencia mínima.
            - $f_{max}$, frecuencia máxima.

** Señales digitales
- Codificamos bits en niveles de una señal.
- Puede tener más de un nivel.
- *número bits por nivel* = $log_2{n}$
      - $n$, número de niveles.

*** Tasa de bits
- La mayoría de señales digitales no son periódicas.
- número de bits enviados en un segundo (bps).
- *Intévalo de bit*, velocidad propagación x duración del bit

*** Transmisión de señales digitales
- Una señal digital es una señal analógica compuesta por un ancho de banda infinito.
      - No es posible en la vida real.
- *Transmisión en banda base*
      - consiste en enviar una señal digital sin cambiar a una señal analógica.
            - Las ondas preservan la forma digital.
      - Requiere de un *canal paso-baja*.
            - Canal con un ancho de banda que comienza en 0.
            - Transmitir en *banda base* una señal digital que preserva su forma solo es posible con un
              ancho de banda infinito y muy grande.
      - $B=\frac{N}{2}$
            - $B$, ancho de banda analógico.
            - $N$, número de bits a enviar.
            - Se divide entre 2 porque en el peor caso sería 10101010...,
              como la señal seno en un periodo tiene un pico positivo y uno negativo,
              en un periodo puede transmitir dos bits como máximo.
      - Podemos añadir armónicos para mejorar la forma de la señal, en este caso.
      - $B = \frac{aN}{2}$.
            - $a$ es el armónico mayor que vamos a usar.

- *Transmisión en banda ancha*
      - Usando modulación (por ejemplo modificar la amplitud de la onda).
      - Implica cambiar la señal digital a analógica.
            - Permite el uso de un *canal paso-banda*.
                  - Canal con un ancho de banda que NO empieza en 0.
        
** Deterioro de la transmisión  
*** Atenuación
- Pérdida de energía (normalmente pérdida de poténcia).
      - Poténcia: $P=V \cdot I = \frac{E}{t} = I^2 \cdot R$
- Se usan *amplificadores* para compensar la pérdida de energía de las señales.
- *Decibelio*: mide las potencias relativas de dos señales.
      - $dB = 10\ log_{10}\frac{P_2}{P_1}$
            - positivo aumenta, negativo disminuye
      - $dB_f = \sum dB_i \quad : \quad i \in \mathbb{N}$
            - decibelio resultante es la suma de decibelios intermedios.

*** Distorsion
- Una señal cambia la forma de su onda.
- Ocurre en una señal compuesta cada señal componente tiene su propia propagación.

*** Ruido
- *Ruido térmico*, movimiento aleatorio de electrones en un cable.
- *Ruido inducido*, fuentes externas (motores, electrodomésticos).
- *Cruces de comunicaciones*, se debe al efecto de un cable roto.
- *Ruido de impulso*, un pico de potencia que viene de líneas de potencia, iluminación, etc.
- *Relación señal/ruido (SNR)*
      - Relación entre la señal y el ruido.
      - $SNR = \frac{\bar{P_s}}{\bar{P_r}}$
            - $\bar{P_s}$ potencia media de la señal.
            - $\bar{P_r}$ potencia media del ruido.
      - $SNR_{dB} = 10\ log_{10}SNR$
            - Se describe a menudo en decibelios.

** Límites de la velocidad de transmisión
- bps, la velocidad depende de:
      - Ancho de banda
      - Niveles de las señales que usamios
      - Calidad del canal (nivel de ruido)

*** Canal sin ruido, tasa de bits de Nyquist
- $Tasa\ bits = 2 \times B \times log_2L$
      - $Tasa\ bits$, bps.
      - $B$, ancho de banda.
      - $L$, niveles.
      - 2 porque un periodo puede aportar hasta dos bits.
- Incrementar demasiado los niveles de la señal disminuye la fiabilidad.

*** Canal con ruido: capacidad de Shannon
- $C = B \times log_2(1 + SNR)$
      - $C$, capacidad del canal en bps.
      - $B$, ancho de banda
- No importa los niveles $L$ que tengamos, No se puede conseguir una velocidad mayor que la capacidad del canal.

*** Usando ambos límites
- Con la capacidad de Shannon encontramos el límite superior.
- Con Nyquist definimos los niveles para la tasa deseada inferior al nivel superior.

** Rendimiento
- Términos para hablar de rendimiento

*** Ancho de Banda
- *Ancho banda en hercios*, Rango de frecuencias.
- *Ancho banda en bps*, número de bits por segundo de un canal.
- Mayor ancho de banda en hercios mayor ancho de banda en bps.

*** Tasa de transferencia relativa (throughput)
- bps reales de un canal, siempre es inferior al ancho de banda del canal.
- Se de a congestiones y otras causas.

*** Latencia
- Cuanto tarda un mensaje completo en llegar a su destinatario desde la salida del primer bit en la fuente.
- *Latencia = tiempo propagación + tiempo de transmisión + tiempo de cola + retardo de proceso*
- *Tiempo Propagación*
      - tiempo de viaje de un bit desde el origen al destino
      - *Tiempo propagación = distancia/velocidad de propagación*
- *Tiempo de transmisión*
      - *Tiempo de transmisión = tamaño del mensaje / ancho de banda (bps)*
- *Tiempo de cola*
      - Tiempo necesario para que cada dispositivo intermedio mantenga el mensaje en espera
        antes de que pueda ser procesado.

*** Producto ancho de banda - retardo
- número de bits que llenaría el canal.
- *2 x ancho de banda (Hz) x retardo*
      - Tamaño de cada ráfaga para aprovechar la capacidad del enlace.

*** Fluctuación del retardo (jitter)
- Los paquetes llegan con distintos retardos.
- Puede ser un problema para aplicaciones sensibles al tiempo.

** Codificación de línea
- Convertir datos digitales en señales digitales.
  
*** Características
- *Elemento señal frente a elemento de datos*
      - *Elemento dato*, la unidad más pequeña de información (bit).
      - *Elemento señal*, unidad más corta en el tiempo de una señal digital.
      - Elementos dato son transportados elementos señal son portadores.
            - Tasa $r$, elementos dato transportados por una señal.
- *Tasa de datos frente a tasa de señales*
      - Tasa de datos son los bps
      - *Tasa de señales*, número de elementos señal enviados en 1 segundo (*baudios*).
            - También se conoce como tasa de pulsos, tasa de modulación o tasa de baudios.
      - Se busca incrementar tasa de datos y reducir tasa de señales.
      - $S = N/r$
            - $S$, Tasas de señales (baudios).
            - $N$, Tasa de datos (bps).
            - $r$. elementos dato por cada señal.
      - $S_{ave}=c \times N \times \frac{1}{r}\ baudios$
            - $S_{ave}$, señales promedio.
            - $c$, factor de caso, varia en cada caso.
      - $B_{min} = c \times N \times \frac{1}{r}$
            - $B_{min}$, ancho de banda de frecuencias mínimo
      - $N_{max} = \frac{Br}{c}$
            - Si se conoce el ancho de banda de frecuencias se puede determinar la tasa de bits máxima.
- *Variaciones de la línea base*.
      - Media de la potencia recibida.
      - Se identifican 1 o 0 comparando la señal con la línea base.
- *Componendes DC* (corriente continua)
      - Frecuencias bajas que aparecen con señales de voltaje constante.
      - Pueden ser problemáticos con algunos dispositivos.
- *Autosincronización*
      - Los intérvalos del emisor deben coincidir con los intérvalos del receptor.
- *Detección de errores incorporada*
      - capacidad de detección de errores en el codigo generado.
- *Inmunidad al ruido y las interferencias*
      - que el esquema de codificación es inmune al ruido y las interferencias.
- *Complejidad*
      - Un esquema complejo es más costoso de implementar.

*** Esquemas de codificación de línea
**** Unipolar
- Todos los niveles de señal se encuentran a un lado del eje del tiempo.
- *NRZ* (sin retorno a cero)
      - bit como 1 voltaje positivo
      - bit como 0 voltaje 0
      - 
         [[file:images/NRZUnipolar.png]]
**** Esquemas Polares
- Voltajes a ambos lados del eje del tiempo.
- *NRZ* (sin retorno a cero)
      - *NRZ-L*, voltaje determinal el valor del bit
      - *NRZ_I*, La inversión del voltaje determina el valor del bit
            - Si el voltaje cambia bit=1, 0 si no cambia.
      - 
        [[file:images/NRZBipolar.png]]
      - Tasa de señal media N/2 baudios
      - Tienen problemas de componentes DC.
- *RZ* (con retorno a cero)
      - La señal cambia durante el bit
      - Evita problemas de componentes DC
      - Mejora la sincronización entre emisor y receptor
      - 
        [[file:images/RZPolar.png]]
- *Bifásica*
      - *Manchester*
            - RZ + NRZ-L
            - El bit se divide en 2 el voltaje cambia en la segunda mitad.
            - 
              [[file:images/ManchesterPolar.png]]
      - *Manchester Diferencial*
            - RZ + NRZ-I
            - El bit se divide en 2, al inicio del bit el voltaje se invierte si el bit es 0.
              no se invierte si el bit es 1.
            - 
              [[file:images/ManchesterDiferencialPolar.png]]
      - La transición a mitad del bit ofrece sincronización.
      - El ancho de banda mínimo es dos veces NRZ.

**** Esquemas Bipolares
- Voltajes de tres niveles positivo, negativo y cero.
- Sin componente DC
      - Alterna voltajes o lo mantiene a 0.
- Misma tasa de señales que NRZ
- *AMI* (bipolar con inversión de marca alternada)
      - Voltaje neutro es 0, voltajes alternados (+, -) es 1
      - Se suele usar en comunicaciones de larga distancia
      - 
        [[file:images/AmiBipolar.png]]
- *pseudoternaria*,
      - Voltaje neutro es 1, alternados (+,-) es 0
      - 
        [[file:images/PseudoternariaBipolar.png]]

**** Esquemas Multinivel
- Incrementar el número de bit por baudio
      - Se codifica un patrón de $m$ elementos de datos en un patrón de $n$ elementos señal.
      - $m$ elementos dato -> $2^m$ patrones.
- los esquemas *mBnL* indican *m* elementos binario (*B*) codificados en un patrón *n* elementos señal.
  *L* significa los niveles de la señal
- *2B1Q*, dos binario 1 cuaternario.
      - Codifica dos bits en una señal de dos cuatro niveles.
      - Tasa señal: $S = \frac{N}{4}$
      - No hay patrones de señal redundantes.
      - Se utiliza en la tecnología DSL.
- *8B6T*
      - Codifica 8 bits en 6 elementos señal de tres niveles.
      - $2^8 = 256, \quad 3^6=729$
            - $729 - 256 = 473$ elementos señal redundantes (sincronización, control de errores, equilibrio DC)
      - Los patrones de señal tienen peso 1 o 0 (suma de voltajes positivos y negativos).
            - Si dos patrones seguidos tienen peso 1, el segundo se invierte para que de peso -1.
            - Así se asegura el equilibrio DC.
      - Tasa media: $S_{ave} = 1/2 \times N \times 6/8$
      - $B_{ave} = 3N/4$
- *4D-PAM5*
      - Tetradimensional con modulación por amplitud de pulso de cinco niveles.
            - 4D porque los datos se envían en 4 cables.
      - 5 niveles de voltaje (-2,-1,0,1,2).
            - Nivel 0 para detección de errores.
            - Los otro cuatro nieveles crean algo similar a *8B4Q*.
      - Peor tasa de señal es $S_{bad} = N \times 4/8 \times N/2$.
      - $B_{ave} = N/8$.
      - LAN Gigabit usa esta técnica, datos a 1Gbps.
            - 125 MBaudios
      - Esquema con mucha redundancia
            - $2^8=256, \quad 4^5=1024$

**** Multitransmisión
- *MLT-3*
      - Transmisión multilínea, codificación de tres niveles.
      - codificiación diferencial
            - Si el siguiente bit es 0, no hay transición.
            - Si el siguiente bit es 1 y el nivel actual *no* es 0, el siguiente nivel es 0.
            - Si el siguiente bit es 1 y el nivel actual es 0, el siguiente nivel es opuesto al último nivel distinto de 0.
      - Reduce el ancho de banda (Hz)
      - $B_{ave} = N/3$

** Codificación por bloques
- Ofrece redundancia, mB/nB m bits en un bloque de n bits n>m.
- *4B/5B*, 4 binario 5 binario
      - Diseñado para usar en combinación con *NRZ-I* para evitar problemas de sincronización.
      - Se combina para que nunca aparezcan más de tres 0s consecutivos.
      - Los grupos que no codifican uno de los $2^4$ patrones se usan para control o no se usan.
      - los bits redundantes añaden un 20% más de baudios.
      - No soluciona el problema de componente DC.
- *8B/10B*, 8 binario 10 binario
      - Mayor capacidad de detección de errores que 4B/5B.
      - Combinación de 5B/6B y 3B/4B.
      - Para evitar largas secuencias de 0 o 1 se usa un controlador de disparidad.
            - sigue la pista del exceso de 0 sobre 1 (o viceversa).
            - Si los bits aumentan la disparidad en un bloque, estos se complementan.
      - $2^{10} - 2^8 = 768$ grupos redundantes para comprobar disparidad y detección de errores.

** Aleatorización  
- Se modifica *AMI* (no tiene DC) para evitar largas secuencias de 0s y ofrecer sincronización.
- Para comunicaciones de largas distancias.
- *B8ZS*
      - Bipolar con sustitución de 8 ceros.
      - Usado en Norteamerica.
      - 8 voltajes nivel 0 es sustituido por *000VB0VB*.
            - *V* significa violación,  que rompe la regla del voltaje opuesto.
            - *B* significa bipolar, sigue la regla del voltaje opuesto.
- *HDB3*
      - Bipolar de alta densidad con 3 ceros.
      - Usado fuera de Norteamerica.
      - 4 voltajes de nivel 0 se sustituye por *000V* o *B00V*.
            - Pulsos distintos de 0 antes de la sustitución es par -> *B00V*.
            - Pulsos distintos de 0 antes de la sustitución es inpar -> *000V*.
            - Se tienen en cuenta las sustituciones anteriores en el recuento de pulsos.

** Conversión analógica a digital  
- Técnicas para la codificación digital de señales analógicas (audio, fotos).

*** Modulación por codificación de pulsos (PCM)
**** Etapas
 1. Se *muestrea* la señal analógica.
        - Muestreo cada $T_s$ (intérvalo de muestreo o periodo)
        - $f_s = 1/T_s$ frecuencia de muestreo.
        - *Tasa de muestreo*
              - Nyquist dijo que la tasa de muestreo *almenos el doble* de frecuencia que la frecuencia más alta de la señal.
 2. Se *cuantifica* la señal muestreada.
        - El muestreo puede tener infinitos valores intermedios, no es viable. Pasos
              1. Se asume que la señal analógica original tiene amplitudes instantáneas entre $V{min}$ y $V_{max}$.
              2. Se divide el rango en L zonas de ancho $\Delta$.
                 $\Delta = \frac{V_{max} - V_{min}}{L}$
              3. Se asignan valores cuantificados de 0 a L-1 en el punto medio de cada zona.
              4. Se aproxima el valor de la amplitud de la muestra a los valores cuantificados.
        - Según el tipo de señal harán falta más niveles de cuantificación (En audio normalmente $L=256$).
        - Error de cuantificación proviene de encajar valores reales a valores aproximados.
              - El valor aproximado es el centro de cada zona de cuantificación, por tanto.
              - $-\Delta/2 \leq error \leq \Delta/2$
        - Para muchas aplicaciones es preferible cuantificación no uniformem, la altura $\Delta$ no es fija.
              - Detalle donde interesa
              - Reduce el $SRN_{dB}$
 3. Los valores cuantificados son *codificados* como flujos de bits.
        - Cada muestra se cambia a una palabra de un código de $n_b$ bits.
        - Número de bits a partir del número de niveles de la cuantificación.
        - $Tasa\ de\ bit =f_s \times n_b$
**** Recuperación de la señal
- Requiere un decodificador PCM.
      - Convierte palabras en pulsos.
      - Se filtra la señal para suavizarla (filtro paso-baja)

**** Ancho de banda PCM
- Ancho de banda mínimo para una señal digitalizada.
- $B_{min} = n_b \times B_{analog}$

**** Tasa de datos máxima de un canal
- L niveles fijos, canal de paso-baja con ancho de banda B Hz, muestreo $2 \times B$
- $N_{max} = 2 \times B \times log_2L\ bps$

**** Ancho de banda mínimo requerido
- ancho de banda mínimo para la tasa de datos anterior.
- $B_{min} = \frac{N}{2 \times log_2 L} Hz$

*** Modulación Delta
- Mas simple que PCM
- Cambio respecto a la muestra anterior.

**** Modulador
- flujo de bits que registra cambios. 1 si delta es positivo, 0 si delta es negativo (señal escalera).
- Un comparador compara la amplitud de la muestra actual con la señal escalera anterior.
      - Del resultado un modulador decide si el siguiente valor es 1 o 0.

**** Demodulador
- Toma la señal escalera y crea la señal analógica. Requiere un filtro para su suavizado.

****  DM Adaptativa
- Se pueden conseguir mejores resultados si $\Delta$ no es fija (según la amplitud de la señal).

**** Error cuantificación
- Menor que en PCM.

** Modos de transmisión
- Transmisión entre dispositivos
  
*** Transmisión paralela
- Grupos de $n$ bits al mismo tiempo.
- $n$ hilos para $n$ bits, en cada pulso de reloj se pueden mandar $n$ bits.
- Más rápido pero más caro

*** Transmisión en serie
- Un bit sigue a otro, un solo canal.
- Dentro del dispositivo se traduce a palabras.
  
**** Asíncrona
- La temporización no es importante.
- se añade un bit extra al principio de cada byte para avisar que empieza una transmisión.
- bits adicionales al final de quda byte para avisar de la parada.
- es barata y efectiva pero lenta.
  
**** Síncrona
- Tramas más largas que contienen múltiples bytes.
- Sin bits de inicio/parada.
- Se usa una trama especial de 1 y 0 para indicar vacío.
- Es rápido

**** Isócrona
- Garantiza que los datos llegan a una tasa fija.

** Digital a analógico
- $S = N/r$
  - $S$, Tasas de señales (baudios).
  - $N$, Tasa de datos (bps).
  - $r$. elementos dato por cada señal.

*** ASK (Amplitude Shift keying)
- Modulación por desplazamiento de amplitud.
- *BASK*, dos niveles de amplitud, 0 en amplitud 0, 1 con alguna amplitud.
- $B = (1+d) \times S$
      - $B$, ancho de banda Hz
      - $S$, tasa de señal (baudios)
      - $d$, [0,1] factor que depende del proceso de modulado y de filtrado.

*** FSK (Frecuency shift keying)
- Modulación por desplazamiento de frecuencia.
- *BFSK*, Se piensa como en dos frecuencias portadoras, una para 1 y la otra para 0.
- *MFSK*, fsk multinivel, hay más de dos intérvalos de frecuencias para mandar más de un bit por elemento señal.
      - 8 intérvalos pueden enviar 3 bits.
- $B = (1+d) \times S + 2\Delta_f$
      - $B$, Ancho de banda Hz
      - $S$, Tasa de señal (baudios)
      - $d$ [0,1] factor que depende del proceso de modulación.
      - $2\Delta_f$, Diferencia entre las dos frecuencias portadoras

*** PSK (Phase shift keying)
- Modulación por desplazamiento de fase.
- *BPSK*, en fase 1 en desfase 0 (0 y $\pi$).
- *QPSK*, versión en cuadratura de PSK.
  
*** QAM (Quadrature amplitude modulation)
- Se altera la fase y la amplitud.
- Combinación de ASK y PSK.

** Analógico a analógico
*** AM (Amplitude modulation)
- Se altera la amplitud.
- $B_{AM} = 2B_{Orig}$
- Rango de frecuencias portadoras de radio AM [530, 1700]KHz.
- La frecuencia portadora de cada estación de radio AM está separada almenos 10KHz de las otras frecuencias AM.

*** FM (Frequency modulation)
- Se altera la modulación.
- $B_{FM}=2(1+ \beta)B_{Orig}$
      - $\beta$ depende de la técnica de modulación.
- Cada estación de radio tiene 200KHz.
      - Con separación entre estaciones de 200KHz.

*** PM (Phase modulation)
- Se altera la fase.
- $B_{PM}=2(1+\beta)B_{Orig}$

** Multiplexación
*** Multiplexación por división de frecuencia (FDM)
- Multiplexación de Señales analógicas que combina señales analógicas.
- Se modulan sobre distintas señales portadores, que se combinan en una sola señal compuesta.
- Multiplexación por grupos o jerarquía, hay etapas de multiplexación, como un grafo.
      - 12 canales $\to$ grupo
      - 5 grupos $\to$ supergrupo
      - 10 supergrupo $\to$ master grupo
      - 6 master grupo $\to$ grupo Jumbo

*** Multiplexación por división de longitud de onda (WDM)
- Multiplexación de Señales analógicas que combina señales ópticas.
- Combina diferentes haces de luz en una sola luz (prismas y fibra óptica).

*** Multiplexación por división de tiempo (TDM)
- Multiplexción digital, combina canales de tasa baja en uno de tasa alta.

- *TDM síncrona*
      - *Ranura*, bloque de datos en espacio de tiempo.
      - $T_{M} = T_{E}/n$
            - En la multiplexación de $n$ señales La *ranura* de salida es $n$ veces más corta que la ranura de entrada.
      - De las conexiones de entrada se coge una ranura de cada en rondas.
            - *Tramas*, ranuras de una ronda completa, una para cada emisor.
      - Si un emisor no emite puede darse ranuras vacías.
      - Multiplexación multinivel
            - Si hay diferentes tasas de datos. pueden multiplexarse los más bajos para que coincidan con los más altos.
      - Multiplexación multiples ranuras.
            - pues demultiplexarse un emisor para rellenar las ranuras de un multiplexor posterior.
      - Inserción de pulsos, relleno para las tasas más bajas y así asemejarlas a las tasas más altas.

- *TDM estadística pot división de tiempo*
      - Solo cuando una entrada tiene datos que enviar se le asigna una ranura.
      - Requiere direccionamiento para identificar el receptor (unos bits).

** Espectro ensanchado
- Se intenta evitar las interferencias o escuchadores intrusos.
- Ancho de banda bastante mayor del necesario (redundancia).
- El proceso de ensanchado $B \to B_{ss}$ debe ser un proceso independiente de la creación de la señal.

*** Espectro ensanchado por salto de frecuencia  (FHSS)
- Se va saltando de frecuencia cada periodo de tiempo.

*** Espectro ensanchado por secuencia directa (DSSS)
- Es como que se añade mucho relleno de bits y patrones.

* Nivel Enlace de Datos
** Descripción
- Paquete: trama.
- Los enrutadores son los responsables de elegir los mejores enlaces entre redes.
      - Cuando un enrutador elige el siguiente enlace, el nivel de enlace es responsable de tomar el datagrama y moverlo a través del enlace.
      - La comunicación es de nodo a nodo.
- Hay control de errores.
- No hay control de la congestión normalmente.
- *Categoría de enlaces*
      - *Punto a punto*, Enlace dedicado (cable entre 2 dispositivos)
      - *broadcast (difusión amplia)*, Enlace compartido (aire)
- *Dos subniveles*
      - *DLC*, Control de enlace de datos
      - *MAC*, Control de enlace de medios (enlace de difusión)
- Dirección de enlace = dirección física = dirección MAC
      - ##:##:##:##:##:## (hexadecimal) 6 bytes.
      - Direcciones de enlace en la trama van cambiando a lo largo del recorrido del paquete.
      - Cada interfaz de cada host tiene una dirección de enlace única.
      - *Dirección unidifusión (unicast)*, destinado a una sola interfaz.
      - *Dirección multidifusión (multicast)*, uno a muchos con jurisdicción local.
      - *Dirección de broadcast*, se envía a todas las entidades de la red.
            - FF:FF:FF:FF:FF:FF
- *protocolo ARP*, Es de nivel de red, pero sirve para conocer las direcciones de enlace de otros dispositivos en la red.
      - Actualización de la tabla arp en el sistema.
      - Consulta *broadcast* respuestas *unicast*.

** DLC Control de enlace de datos
- Se ocupa del procedimiento para la comunicación entre dos nodos adyacentes.
      - Entramado, control de flujo y errores.
- *Protocolos orientados al caracter*
      - Datos como texto
      - Se colocan unas flags de 8 bits al inicio y final de la trama.
      - Transparencia a nivel byte, se escapan (\) los carácteres problematicos o confusos.
- *Protocolos orientados al bit*
      - Datos como bits
      - Se usan flags como delimitadores. 01111110
      - Transparencia bit, para evitar confusión con las flags.
            - 011111... -> 0111110... , se añade un 0
- *Buffer*, ayudan a regular el control de flujo.
      - presentes en emisor y receptor.

- Para control de errores
      - Método 1, Lan cableadas si la trama está corrompida se descarta silenciosamente.
      - Método 2, Si no está corrompida se devuelve un *ACK*, sino se descarta silenciosamente.
            - *ACK*, acuse de recibo, control de errores y de flujo.
                  - En enlace de datos solo existe en conexiones locales no cableadas.
                  - ACK MAC para comprobar que llegó el paquete sin cables.
                  - El ACK suele indicar la secuencia del paquete que espera recibir.
            - *Piggybacking*, En comunicación bidireccional se incluyen los acuse de recibo en los mensajes que circulan en ambas direcciones.
*** Protocolos
- *HDLC (High-level data link control)*, Control de enlace de datos de alto nivel
      - orientado a bit.
      - dos modos
            - *NRM* respuesta normal
                  - Estación primaria envía comandos, estación secundaria solo responde.
            - *ABM* asíncrono balanceado
                  - Las estaciones pueden fucionar como primarias o como secundarias.
      - Typos de tramas
            - *Tramas I*, de información
                  - | flag | Dirección | Control | Inf de usuario | FCS | FLAG |
            - *Tramas S*, de supervisión
                  - | flag | Dirección | Control |FCS | |
                  - Cuando piggybacking no es posible.
            - *Tramas U*, sin numeración
                  - | flag | Dirección | Control | Inf de Control | FCS | FLAG
            - FCS, campo de detección de errores de HDLC
- *PPP* (protocolo punto a punto)
      - El más frecuente
      - NO proporciona control de flujo
      - orientado al carácter
      - | flag | dirección | Control | Protocolo | Carga util (bytes) | FCS | FLAG |
            - campo dirección constante broadcast
      - En la carga útil puede llevar paquetes de otros protocolos PPP diseñados para el control.
            - *LCP*, protocolo de control de enlace.
                  - establecer mantener y configurar enlaces.
            - *AP*, protocolo de autentificación
                  - *PAP*, autentificación por contraseña
                  - *CHAP*, autentificación por reto.
                        - Ambos extremos tienen la contraseña pero no se comparte.
                        - aplican una función con la contraseña junto con unos pocos bits que se comparten y comparan resultados.
            - *NCP*
                  - *IPCP*, configura el enlace para transportar paquetes IP.
                        - Después ya pueden compartir paquetes.
                          
** MAC control de acceso al medio
- Protocolos de acceso multiple
      - Protocolos de acceso aleatorio
            - ALOHA
            - CSMA
            - CSMA/CD
            - CSMA/CA
      - Protocolos de acceso controlado
            - De reserva
            - Muestreo
            - Paso testigo
      - Protocolos de canalización
            - FDMA
            - TDMA
            - CDMA

*** Acceso aleatorio
**** Aloha
***** *Aloha puro*,
- Canal compartido
- Una estación emite en el canal cuando tiene una trama preparada.
- Cuando una estación envía una trama espera una respuesta del receptor.
- Si en un cierto tiempo no hay respuesta asume que la trama se ha perdido.
      - En este caso cada estación espera un tiempo determinado más un tiempo aleatorio aleatorio $T_B$ (Backoff time).
- Después de $K_{max}$ intentos fallidos la estación debe parar e intentarlo más tarde.
            - Periodo de espera es $2 \times T_p$.
            - $T_p$ tiempo de propagación máximo. Tiempo de enviar una trama entre las dos estaciones más separadas.
- *Periodo vulnerable* (existe posibilidad de colisión)
      - periodo vulnerable = $2 \times T_{fr}$
            - $T_{Fr}$, Tiempo de transmisión medio de una trama.
- *Tasa de transferencia efectiva o productividad*
      - $S = G \times e^{-2G}$
            - $G$, número medio de tramas generadas por el *sistema* (todas las estaciones) durante el tiempo de transmisión de una trama.
      - $S_{max} = 1/(2e) = 0.184$ cuando $G=1/2$

***** *Aloha con ranuras*
- Se divide el tiempo en ranuras de $T_{fr}$
- Las estaciones solo envían al comienzo de una ranura.
- Periodo vulnerable = $T_{fr}$
- *Productividad*
      - $S = G \times e^{-G}$
      - $S_{max} = 0.368$ cuando $G=1$

**** CSMA        
- Acceso múltiple por detección de portadora (CSMA).
- Se comprueba el medio antes de usarlo.
- El retardo de propagación puede generar colisión igualmente.
- *Periodo vulnerable*
      - $T_p$, el tiempo de propagación.
- *Métodos de persistencia*
      - persistencia 1, si el medio está libre envía la trama inmediatamente.
            - Mayores colisiones.
      - No persistencia, Si el medio está libre envía inmediatamente.
            - Si no lo está espera un tiempo aleatorio y vuelve a probar.
      - Persistencia P, Se usa si el tiempo de una ranura es mayor al tiempo de propagación.
            1. Si la línea está libre con probabilidad $p$ envía la trama.
            2. Con probabilidad $1-p$ se espera a la siguiente ranura de tiempo.
                   - Si está libre se pasa a 1.
                   - Si está ocupada se espera un tiempo aleatorio.
**** CSMA/CD
- Acceso múltiple por detección de portadora y detección de colisiones (CSMA/CD).
- Se monitoriza el medio después de enviar una trama.
      - Si no se detecta otra trama la transmisión se realiza con éxito.
            - No se guarda la trama.
      - Si hay colisión (otra trama detectada) se envía luego de nuevo.
- Tamaño de la tarma mínima.
      - $T_{Fr} = 2 \times T_{p}$
- *Procedimiento*
      - Transmisión detección continuo.
      - *Señal de interferencia*, de envía una señal corta en caso que otras estaciones no hayan detectado la colisión.
- *Nivel de energía*
      - Cero, canal libre.
      - normal, la estación está usando el canal.
      - anormal, hay una colisión y el nivel de energía es dos veces el normal.
- *Productividad*
      - Mayor que Aloha.

**** CSMA/CA
- Acceso múltiple por detección de portadora y evitación de colisiones.
- Se evitan las colisiones con
      - Espacio entre tramas (IFS), No se emite inmediatamente, se espera un periodo llamado IFS.
            - Así se comprueba que no se detecta el inicio de la transmisión de otra estación.
      - Ventana de contención, Cantidad de tiempo dividido en ranuras.
            - La estación elige un número de ranuras aleatorio como su tiempo de espera.
            - El número de ranuras se duplica cada vez que no se puede emitir.
            - 
      - Confirmaciones
            - Confirmación por parte del receptor y temporizadores.
- Linea de tiempo de intercambio de trama
      1. Se detecta el medio
             - Persistencia con retroceso hasta que el canal está inactivo.
             - Espera *DIFS* (espacio interframe), evía una trama de control *RTS* (solicitud de envío).
                   - Se incluye el NAV, que indica el tiempo que se necesitará ocupar el medio.
      2. La estación destino tras recibir el *RTS* espera *SIFS* (short interframe space) y envía *CTS* (clear to send, permiso para enviar).
      3. La estación origen tras recibir el CTS espera SIFS y retrasmite.
      4. El destino después de esperar SIFS envía un ACK.

- Si no se recibe un CTS se asume que ha habido colisión y se vuelve a intentar.         

# TODO gráfico pag 308  

*** Acceso Controlado
- Las estaciones consultan unas a otras quien puede enviar.

**** Reserva
- Tiempo dividido en intérvalos
- Trama de reserva, contiene $n$ ranuras en un sistema de $n$ estaciones.
      - Si una estación necesita enviar datos hay un 1 en su miniranura.
      - Las estaciones que han hecho reserva pueden enviar sus tramas depués de la trama de reserva.

**** Muestreo
- Topologías con una estación primaria.
- Dispositivo primario controla el enlace.
- *Selección*
      - El nodo primario debe alertar a el nodo secundario de su deseo de transmitir (trama de selección SEL).
      - El nodo secundario debe confirmar que está listo.
  
- *Muestreo*
      - El nodo primario pregunta (muestrea) a los secundario si tienen algo para enviar.
      - El nodo secundario responde con una trama *NAK* si no tiene nada que enviar.
      - Si la respuesta es positiva, una trama de datos, el primario devuelve una trama *ACK* al noso secundario.

**** Paso de testigo
- Organización de anillo lógico.
- El derecho a usar el canal (testigo) es concedido por el nodo predecesor.
      - El *Testigo* es un paquete especial que cricula a través del anillo.
- Es necesaria una gestión del testigo para evitar que se destruya o un nodo lo acapare demasiado tiempo.
- Algunas topologías en anillo
      - Anillo físico
            - conexiones físicas en anillo.
            - si falla un nodo cae el sistema.
      - Anillo dual
            - Segundo anillo en dirección inversa por si fallan conexiones.
            - Cada nodo necesita dos puertos.
      - Anillo en bus.
            - La conexión física es un bus, pero el comportamiento lógico es en anillo.
      - Anillo en estrella.
            - Topología física es en estrella.
            - Un concentrador central (o conmutador).
            - Los nodos se conectan al concentrador con dos cables (entrada/salida).

*** Canalización
- Método de acceso múltiple.
- El ancho disponible del enlace se comparte.

**** FDMA, Acceso múltiple por división de la frecuencia
- Ancho de banda disponible se divide en bandas de frecuencia separadas por bandas de guarda.
- Cada estación tiene asignada una banda.
      - Aplican un filtro paso-banda para confinar la frecuencia.
- El nivel de enlace determina a su nivel físico el ancho de banda, no hace falta un multiplexor físico de señales.
      - Las señales se combinan en el canal.

**** TDMA, Acceso múltiple por división de tiempo
- Cada estación tiene asignada una ranura de tiempo.
- Es dificil conseguir la sincronización entre diferentes estaciones.
- *Tiempo de guarda*, tiempo que se inserta para compensar los retardos de la propagación.
- El nivel de enlace determina la ranura de tiempo al nivel físico, no hay un multiplexor físico.

**** CDMA, Acceso múltiple por división de código
- Un solo canal transporta todas las transmisiones y todas las estaciones pueden enviar al mismo tiempo.
- Idea
      - Cada estación tiene un código $c_i$.
      - si $a \neq b\ \to c_a \times c_b = 0$
      - $c_a \times c_a = n$
      - $d_i$ son los datos de la estación $i$
      - Cada estación $i$ emite $d_i \times c_i$
      - El canal común $C_m = \sum_{i=1}^n d_i \times c_i$
      - Si el equipo $a$ quiere los datos de $b$ hace $C_m \times c_b = nd_b$
- Chips
      - secuencia de números que forman $c_i$.
      - Ejemplo
            - [+1 +1 +1 +1]
            - [+1 -1 +1 -1]
            - [+1 +1 -1 -1]
            - [+1 -1 -1 +1]

      - Secuencias *Ortogonales*
            - $N$ elementos donde $N$ es el número de estaciones.
            - $a \cdot [x_1 \dots x_n] = [ax_1 \dots ax_n]$
            - $c_a \cdot c_b = c_a_1 \cdot c_b_1 + \dots + c_a_n \cdot c_b_n$
            - $c_a + c_b = [c_a_1 + c_b_1\ \cdots\ c_a_n + c_b_n]$
- Datos a transmitir
      - $0 \to -1$
      - $1 \to 1$
      - inactividad $\to 0$
      - Dato enviado $d_i \times c_i$

- Generación de secuencias
      - *Tabla Walsh*,
        # TODO grafico pag 265
      - $N=2^m$ número de secuencias es potencia de 2.

** Lan Cableadas: Ethernet
*** Protocolo ETHERNET
- Evolución Ethernet
      - *Standard Ethernet* 10 Mbps
      - *Fast Ethernet* 100 Mbps
      - *Gigabit Ethernet* 1Gbps
      - *10 Gigabit Ethernet* 10 Gbps

*** Ethernet Stándar, 10 Mbps
**** Características
- Servicio sin conexión e inestable
- Formato de trama
      - *Preámbulo* (7Bytes)
      - *Delimitador de comienzo de trama (SDF)* (1Byte)
      - *Dirección destino* (6Bytes)
            - Dirección de nivel de enlace (MAC)
      - *Dirección origen* (6Bytes)
            - (MAC)
      - *Tipo* (2Bytes)
            - IP, ARP o OSPF
      - *Datos* (46Bytes - 1500Bytes)
            - Si es necesario se añade relleno.
      - *CRC* (4Bytes), campo para detectar erroes.
- Longitud de trama
      - Requerimiento para CSMA/CD con persistencia 1.
      - Evita que una estación monopolize el medio.
      - Antes la memoria era cara.

**** *Direccionamiento*
      - *NIC*, network interface card, tarjeta de red.
            - Cada nodo tiene almenos una.
            - Proporcionala MAC.
      - MAC -> ##:##:##:##:##:##
            - 6 bytes en hexadecimal
            - Se transmiten byte a byte de izquierda a derecha.
            - El bit menos significativo de cada byte se envía antes.
      - Unicast
            - #######0:########:...:########
      - Multicast
            - #######1:########:...:########
            - Mantienen la trama los miembros del grupo.
      - Broadcast
            - FF:FF:FF:FF:FF:FF
            - Todos los miembros reciben y mantienen la trama.
**** Acceso y eficacia              
- Acceso CSMA/CD con Persistencia 1.
- Eficacia = $1 / (1 + 6.4 \times a)$
      - $a$, Tramas que caben en el medio.
      - $a=$ (retardo propagación)/(retardo de tranmisión)
        
**** *Implementaciones*
      - 10Base5
            - Coaxial grueso
            - 500m longitud
            - Codificación Manchester
            - Topología BUS
            - Semiduplex
      - 10Base2
            - Coaxial fino
            - 185m longitud
            - Codificación Manchester
            - Topología BUS
            - Semiduplex
      - 10Base-T
            - 2 UTP, cable de par trenzado
                  - Un trenzado para enviar y otro para recibir.
            - 100m longitud
            - Codificación Manchester
            - Topología en estrella con un concentrador.
            - Fullduplex
      - 10Base-F
            - 2 Fibra
                  - Uno enviar el otro recibir.
            - 2000m longitud
            - Manchester
            - Topología en estrella con un concentrador.
            - Fullduplex

*** Ethernet rápida (100 MBPS)
- Compatible con ethernet estandar
      - Mismo formato de trama
      - Direcciones MAC 48 bit.

**** Método de acceso        
- *Método acceso*
      - CSMA/CD
      - 1a Solucion para colisiones
            - Usa HUB y topología estrella
            - Tamaño máximo de la red 250m
      - 2a solución para colisiones
            - Conmutador con un buffer
            - Topología estrella
            - Conexión fullduplex a cada host
            - No es necesario CSMA/CD (conexiones punto a punto).
      - Autonegociación
            - Cierto margen para establecer las condiciones de una conexión.
            - Permite a dispositivos incompatibles conectarse.
            - Permite a un dispositivo tener múltiples capacidades.
            - Permite a una estación comprobar las capacidades del concentrador.
**** Nivel físico
- Topología estrella con concentrasor/conmutador.
- Implementaciones
      - 100Base-TX
            - 2 UTP categoría 5 (par trenzado)
            - 100m longitud
            - Codificación 4B/5B + MLT-3
      - 100Base-FX
            - 2 Fibra
            - 2000m longitud
            - Codificación 4B/5B + NRZ-I
      - 100Base-T4
            - 4 UTP (par trenzado)
            - 100m longitud
            - Codificación 3 8B6T
            - Para edificios que ya tenían cable de par para voz.

*** Ethernet Gigabit
- IEEE Estándar 802.3z
- Compatible con Ethernet estándar y Fast Ethernet
- MAC de 48 bit.
- Mismo formato de trama.
- Autonegociación como en Fast Ethernet.

**** Subnivel MAC
- Modo Duplex
- Semiduplex es raro
      - CSMA/CD
      - Métodos para detectar colisiones
            - Tradicional, Se reduce la longitud de la red.
            - Extensión de portadora.
                  - Trama mínima más grande
            - Ráfaga de tramas
                  - Se envían multiple tramas

**** Nivel físico                    
- Topología estrella con concentrador/conmutador.
- Varias topologías estrella conectables.
- Implementaciones
      - 1000Base-SX
            - 2 Fibra S-W
            - 500m longitud
            - Codificación 8B/10B + NRZ
      - 1000Base-LX
            - 2 Fibra L-W
            - 5000m longitud
            - Codificación 8B/10B + NRZ
      - 1000Base-CX
            - 2 STP
            - 25m longitud
            - Codificación 8B/10B + NRZ
      - 1000Base-T
            - 4 UTP
            - 100m longitud
            - Codificación 4D-PAM5

*** Ethernet 10 Gigabit
- IEEE estándar 802.3ae
- Válido para LAN y MAN (área metropolitana).

**** Implementación
- Sólo modo Duplex
- Implementaciones
      - 10GBase-SR
            - 2 Fibra 850 nm
            - 300m longitud
            - Codificación 64B66B
      - 10GBase-LR
            - 2 Fibra 1310nm
            - 10km longitud
            - Codificación 54B66B
      - 10GBase-EW
            - 2 Fibra 1350nm
            - 40Km longitud
            - SONET
      - 10Base-X4
            - 2 Fibra 1310nm
            - 300m to 10Km
            - 8B10B

** Lan inalámbrica
- El medio es el aire y se transmite en modo difusión.

*** Características
- *Atenuación*, la señal electromagnética se dispersa en todas las direcciones.
- *Interferencia*, se pueden recibir señales más allá del remitente previsto.
- *Propagación multitrayecto*, recibir más de una señal del mismo emisor por rebotes de las señales.
- *ERROR*, menor SNR,  mayor ruido que en redes cableadas.

*** Control de acceso
- CSMA/CA

*** Proyecto IEEE 802.11
**** Arquitectura
- BSS, Conjunto de servicios básicos
      - Red ad hoc, sin access point, solo nodos.
      - Red con infraestructura, con access point.
- ESS, Conjunto de servicios extendido.
      - Dos o más BSS con AP (access point).
      - Se conectan a un sistema de distribución que suele ser una LAN con cable.
- Tipos de estaciones
      - Estación con *movilidad sin transición*
            - Siempre dentro de una BSS
      - Estación con *movilidad con transición BSS*
            - Puede moverse entre BSS's pero dentro de un ESS
      - Estadión con *movilidad con transición ESS*
            - Se puede mover de un ESS a otro ESS.
      - IEEE 802.11 no garantiza la conexión continua durante el movimiento.

**** Subnivel MAC
- Dos subniveles MAC
      - DCF, función de coordinación distribuida.
            - Control de acceso CSMA/CA
      - PFC, función de coordinación puntual.
            - Método opcional para redes con infraestructura.
            - El AP hace un muestreo de la red.
                  - Las estaciones envian cualquier dato que tengan durante el muestreo.
            - *PIFS* (PCF IFS), es más corto que el DIFS, por ello el muestreo del PFC tiene mayor prioridad que el DCF de las estaciones.
- Fragmentación, el protocolo recomienda dividir tramas grandes en otras más pequeñas.
- Formato de trama
      - *FC* (2Bytes), tipo de trama junto con información de control, subcampos:
            - *versión* (2bit)
            - *tipo* (2bit)
                  - Gestión (00)
                  - Control (01)
                  - Datos   (10)
            - *subtipo* (4bit)
                  - Subtipo Control
                        - 1011, petición RTS
                        - 1100, permiso para enviar CTS
                        - 1101, ACK
            - *A DS* (1 bit), configura el [[id:10cf8465-2adf-4984-94b6-5ca2841c1efb][direccionamiento]].
                  - La trama va hacia un AP (access point).
            - *De DS* (1 bit), configura el [[id:10cf8465-2adf-4984-94b6-5ca2841c1efb][direccionamiento]].
                  - La trama viene de un AP (access point).
            - *más frag*. (1 bit), más fragmentos
            - *reintenta* (1 bit), trama retransmitida
            - *gestión de potencia* (1 bit), significa que la estación está en modo gestión de potencia.
            - *más datos* (1 bit), la estación tiene más datos para enviar.
            - *WEB* (1 bit), cifrado implementado
            - *Rsvd* (1 bit), reservado
      - *D* (2Bytes), Duración de la transmisión para fijar el *NAV*.
      - *Dirección 1* (6Bytes)
      - *Dirección 2* (6Bytes)
      - *Dirección 3* (6Bytes)
      - *SC* (2Bytes)
      - *Dirección 4* (6Bytes)
      - *Cuerpo de la trama* (0-2312Bytes), depende del tipo
      - *FCS* (4Bytes) CRC-32

**** Mecanismo de direccionamiento
:PROPERTIES:
:ID:       10cf8465-2adf-4984-94b6-5ca2841c1efb
:END:
| A DS | De DS | Dirección 1 | Dirección 2 | Dirección 3 | Dirección 4 |
|------+-------+-------------+-------------+-------------+-------------|
|    0 |     0 | Destino     | Origen      | ID de BSSS  | N/A         |
|    0 |     1 | Destino     | AP emisor   | Origen      | N/A         |
|    1 |     0 | AP receptor | Origen      | Destino     | N/A         |
|    1 |     1 | AP receptor | AP emisor   | Destino     | Origen      |

- *A DS=0. De DS=0*, No viene y no va a ningún sistema de distribución.
- *A DS=0. De DS=1*, La trama viene de un sistema de distribución y va hacia una estación.
- *A DS=1. De DS=0*, La trama va un AP (sistema de distribución) desde una estación.
- *A DS=1. De DS=1*, La trama va de AP a un AP.

- Problemas de la estación expuesta
      - Una estación es demasiado conservadora y no usa el canal por pensar que puede generar colisiones.
      - B -emite-> A, A -responde-> B.
      - C no ve a B pero ve la respuesta de A.
      - C quiere comunicarse con D pero piensa que puede interferir con A y no usa el canal.

**** Nivel físico
- *IEEE 802.11 FHSS*
      - Banda 2.4 - 2.4835 GHz
      - Modulación FSK
      - Tasa 1 y 2 Mbps
- *IEEE 802.11 DSSS*
      - Banda 2.4 - 2.4835 GHz
      - Modulación PSK
      - Tasa 1 y 2 Mbps
- *IEEE 802.11 por infrarojos*
      - Banda infrarojo
      - Modulación PPM (modulación por posición de pulsos)
      - Tasa 1 y 2 Mbps
- *IEEE 802.11a OFDM* (multiplexación por división de frecuencias ortogonal)
      - 5.725 - 5.850 GHz
      - Modulación PSK o QAM
      - Tasa 6 a 54 Mbps
- *IEEE 802.11b DSSS*
      - 2.4 - 2.4835 GHz
      - Modulación PSK
      - Tasa 5.5 y 11 Mbps
- *IEEE 802.11g OFDM*
      - 2.4 - 2.4835 GHz
      - Tasa 22 y 54 Mbps
- *IEEE 802.11n OFDM*
      - 5.725 - 5.850 GHz
      - Tasa 600 Mbps

*** Bluetooth
- red ad hoc
- Un dispositivo puede compartir la conexión a internet con el resto de la red.

**** Arquitectura
- *Picorredes*, red bluetooth.
      - Hasta 8 estaciones, una de ellas es la primaria.
      - Estaciones secundarias tienen dos estados
            - Estado estacionado, no contabiliza en el máximo de dispositivos y no participa en la red.
            - Estado activo. Perticipa en la red.
- *Red dispersa*
      - Una estación secundaria en una picored puede ser primaria en otra picored.
- Los dipositivo tiene una radio de corto alzance
      - Tasa actual 1Mbps
      - 2.4GHz ancho de banda.
            - Puede interferir con IEEE 802.11b

**** Niveles de Bluethoot
# TODO pag 318

** Dispositivos de conexión y LAN virtuales
*** Dispositivos de conexión
**** Concentradores
- Funciona a nivel físico
- Repite las señales que se atenuan con la distancia
- No tiene capacidad de filtrado

**** Conmutador del nivel de enlace
- Opera a nivel físico y de enlace.
- Puede comprobar las direcciones MAC contenidas en las tramas y filtrar el mensaje.
- *Conmutadores transparentes*
      - Las estaciones desconocen la existencia del conmutador
      - Según la IEEE 802.1d debe cumplir
            - Tramas deben ser enviadas de una estación a otra.
            - Tabla de encapsulamiento se construye automaticamente mediante aprendizaje de los movimientos de tramas en la red.
            - Evitarse los bucles.
- *Aprendizaje*
      - El conmutador construye una tabla que relaciona dirección MAC con el puerto conectado de entrada.
      - Usa la dirección de origen de una trama para rellenar la entrada del puerto conectado con la dirección conectada.
- *Problema de los bucles*
      - Si hay más de un comutador conectado a la red puede repetirse las tramas en la red.
      - Se suele usar más de un conmutador para asegurar redundancia por si uno falla.
- *Algoritmo del árbol de expansión*
      - Así los conmutadores crean topología sin ciclos.
            - Pueden evitar el problema de los bucles.
      - El conmutador con el id mínimo actua como raiz
            - Los conmutadores tienen un id.
- Eliminación de colisiones
- Conexión de dispositivos heterogéneos.
      - Dispositivos con diferentes niveles físicos.

**** Routers (enrutadores)
- Nivel físico, de enlace de datos y de red.
      - repite la señal, compruena la dirección física y la dirección de red.
- Tiene dirección física y lógica (IP) para cada una de sus interfaces.
- Actua sobre los paquetes con dirección física de destino igual a la dirección de la interfaz que lo recibe.
- Cambia las direcciones de nivel de enlace (física) cuando reenvia el paquete.

*** Lan virtuales
- Red LAN configurada por software
      - No tienen porque pertenecer físicamente a la misma red LAN.
- Permite la agrupación de estaciones conectadas a conmutadores distintos en una VLAN.

**** Pertenencia
- Características que pueden usarse para agrupar estaciones en VLAN.
- *Números de puertos*
      - Números de puertos de un conmutador.
- *Direcciones MAC*
      - La dirección MAC de 48 bit como caractrística de pertenencia.
- *Direccións IP*
      - direcciones IP de 32 bit.
- *Direcciones multicast IP*
- *Combinación*
      - El administrador puede elegir una o más características para definir la pertenencia.

**** Configuración
- *Configuración manual*, El administrador de redes usa el software VLAN para asignar estaciones.
- *Configuración automática*, Según los criterios definidos por el administrador.
- *Configuración semiautomática*, combinación de ambas.

**** Comunicación entre conmutadores
- El conmutador debe conocer que estación pertenece a cada VLAN.
- También debe conocer la pertenencia de estaciones conectadas a otros conmutadores.
- métodos
      - *Mantenimiento de la tabla*, los conmutadores se envían las tablas entre si para actualizarlas.
      - *Marcado de trama*, Cabecera extra a la trama MAC para definir su VLAN destino.
      - *TDM, multiplexación por división en el tiempo*
            - Destino VLAN1 en la celda1, VLAN2 en la celda2, etc

- *IEEE 802.1Q*
  - Indica el formato del marcado de trama.

**** Ventajas
- Reduce costes de migración de estaciones.
- Creación de grupos de trabajo virtuales.
- Seguridad, los miembros de una VLAN gozan de cierta privacidad.

* Nivel de Red
- *Paquete: datagrama de red.*
- Responsable de la conexión lógica entre el dispositivo origen y destino.
- Incluye el protocolo principal IP.
      - IP es un protocolo sin conexión.
      - Sin control de flujo.
      - Sin control de errores.

- Se involucra en el host origen, host destino y todos los enrutadores del camino.

(ICMP, ARP, DHCP, IGMP, )

** Introducción
*** Servicios
- *Paquetizado*, encapsular la carga útil de los niveles superiores.
      - Añade encabezado con las direcciones (ip) de origen y destino.
- *Enrutamiento y reenvio*
      - Enrutar desde el origen al destino, hay más de un camino.
            - Encontrar el mejor camino
      - Reenvio, el enrutador usa su tabla de enrutamiento para redirigir el paquete hacia el siguiente paso.
            - Cambia direcciones físicas (siguiente paso), puede cambiar la ip origen (recibir las respuestas), etc.
- *Control de erroes*, poco más que un CRC
- *Control de flujo*, no implementa directamente ningún control.
- *Control de la congestión*, Algunos enrutadores pueden dejar caer datagramas.
- *Calidad del servicio*
- *Seguridad*, Es una preocupación actualmente.

*** Conmutación de paquetes
- Conexión puerto entrada y puerto de salida.
- Mensaje de nivel superior se divide en paquetes manejables.
      - El destino espera que lleguen todos los paquetes pertenencientes al mensaje antes de pasarlo al nivel superior.

**** Acercamiento de datagrama: servicio sin conexión
- Al iniccio cada paquete es independiente.
      - Pueden viajar por caminos distintos cada paquete.

**** Acercamiento del circuito virtual: servicio orientado a la conexión
- Existe una relación entre todos los paquetes de un mensaje.
- Se establece el camino antes del primer envío.
      - *Identificador del circuito virtual*, El paquete contiene una etiqueta de sentido de flujo (que camino debe seguir).
- tres fases
      - Configuración.
      - Transferencia de datos.
      - Desmontaje.

***** Fase de configuración
- El enrutador crea una entrada para un circuito virtual. Tabla de reenvio.
  | entrante |          | saliente |          |
  | puerto   | eitqueta | puerto   | etiqueta |
  | ..       | ..       | ..       | ..       |

- *paquete de petición*
      1. La fuente envía un paquete de solicitud al enrutador.
             - Lleva las direcciones de origen y destino.
      2. El enrutador conoce el puerto de salida
             - asigna una etiqueta y rellena su tabla de circuito virtual.
      3. Se repite el proceso en los enrutadores del camino
      4. El destino recibe el paquete y asigna una etiqueta de enrtada a la conexión.

- *Paquete de reconocimiento*
      1. El destino responde con la etiqueta que ha asignado.
             - El enrutador conectado a el destino usará esta etiqueta para rellenar su tabla de conexión y saber que puerto de salida corresponde a esta conexión.
      2. Los enrutadores comparten su etiqueta de entrada de la conexión (eligida anteriormente) con el enrutador que le precede.
             - Así los enrutadores podrán identificar cada uno su entrada en la tabla y ayudar a los enrutadores del camino a que encuentren la entrada correcta.
      3. El origen también recibe la etiqueta de su enrutador.
      4. Las fuentes usan la etiqueta de salida para los paquetes que se envían al destino y la etiqueta entrada para los que vuelven al origen.

***** Fase de transferencia de datos
- Desde el origen al destino con su etiqueta.
      - cada enrutador usa la etiqueta de entrada y la cambia por la de salida.
            - La etiqueta salida de un enrutador es la etiqueta de entrada del siguiente en el circuito virtual.
      - Este paso se repite hasta llegar al destino.

***** Fase de desmontaje
- Cuando acaba el proceso desde el origen se envía un paquete especial para borrar las entradas de la tabla de reenvio.

*** Rendimiento en el nivel de red
**** Retardo
- *Retardo de transmisión*
      - $Retardo_{tr} = L_{paquete}/ V_{tr}$
            - $L_{paquete}$, longitud del paquete.
            - $V_{tr}$, velocidad de transmisión.
- *Retardo de propagación*
      - $Retardo_{pg} = D/V_{pg}$
            - $D$, distancia
            - $V_{pg}$, velocidad de propagación
- *Retardo de procesamiento*
      - Tiempo que necesita un enrutador o host para manjejar el datagrama.
            - Eliminar cabecera, reenviar, detección de errores.
      - $Retardo_{pr}$ = Tiempo necesario para procesar un paquete
- *Retardo de cola*
      - Tiempo que un paquete espera en uno de los buffers del enrutador.
            - Una cola por puerto.
      - $Retardo_{qu}$ = Tiempo que un paquete espera en las colas de entrada y salida.
- *Retardo total*
      - $Retardo_{tt} = (n + 1)(Retardo_{tr} + Retardo_{pg} + Retardo_{pr}) + n(Retardo_{qu})$
            - $n$, el número de enrutadores.
            - $(n+1)$, número de enlaces.

**** Tasa de transferencia efectiva
- número de bits que pasan por un punto de la red en un segundo.
- Cada tramo entre enlaces puede tener diferentes velocidades.
      - La tasa de transferencia es la menor de todos los tramos de la red.
- $T_{tr} = min(T_{tr(1)}, ..., T_{tr(n)})$
- Hay que tener en cuenta que pueden haber varios flujos entre dos enrutadores y la velocidad se reparte.

**** Pérdida de paquetes
- El enrutador puede tener sus buffers de entrada completos.

**** Control de la congestión
- *Control de la congestión en bucle abierto (prevención)*
      - *Política de retransmisión*, Esperar si es necesario.
      - *Política de ventanas*, ventana de repetición selectiva.
      - *Política de reconocimiento*, por ejemplo el acude de recibo de N paquetes a la vez.
      - *Política de descartes*, descartar paquetes menos sensibles (en streaming).
      - *Política de admisión*, negarse a establecer la conexión de circuito virtual si hay riesgo de congestión.

- *Control de la congestión en bucle cerrado (eliminicación)*
      - *Contrapresión*, El nodo congestionado corta el flujo con el nodo o los nodos inmediatamente anteriores.
            - Provoca que los nodos inmediatamente anteriores empiecen a congestionarse y reducen el tráfico.
            - Solo impementable en circuitos virtuales.
      - *Paquete de estrangulamiento*, Paquete enviado desde un nodo al origen para avisar (ICMP).
      - *Señalización implícita*, La fuente supone que hay congestión por algunos síntomas.
            - La fuente reduce la velocidad de transmisión.
      - *Señalización explícita*, Una señal que se incluye en los paquetes notifica a la fuente.
            - No es un paquete especial como en el *estrangulamiento*.


*** Direcciones IPV4
- IPV4 32bits $\to 2^32$ direcciones.
- *Notaciones*
      - binario: 10000000 00001011 00000011 00011111
      - punto decinal: 128.11.3.11
      - hexadecimal: 80 0B 03 1F

**** Jerarquía en el direccionamiento
| 32 bits |        |
|---------+--------|
| Prefijo | sufijo |

- *Prefijo*, define la red.
- *Sufijo*, define una conexión en la red. 

**** Direccionamiento con clase
- Obsoleto.
- Los primeros bits definen la clase

| Clase | Prefijos     | bits de clase | Primer byte |
|-------+--------------+---------------+-------------|
| A     | n = 8 bits   |             0 | 0 a 127     |
| B     | n = 16 bits  |            10 | 128 a 191   |
| C     | n = 24 bits  |           110 | 102 a 223   |
| D     | No se aplica |          1111 | 224 a 239   |
| E     | No se aplica |          1111 | 240 a 255   |

- *Agotamiento de direcciones*
      - Pocas direcciones para dar servicio a todo el mundo.
      - La clase C soporta pocas estaciones conectadas.

**** Direccionamiento sin clase
- *Prefijo longitud: notación barra* (CIDR)
      - 
# TODO: seguir aquí

* Nivel de Transporte
- Paquete: datagrama de usuario.
- Responsable de la comunicación lógica entre aplicaciones.
- Da servicio al nivel de aplicación.
- Gestiona el tráfico
- Dirección Socket. ipv4:puerto

** UDP

** TCP

** SCTP

* Nivel de Aplicación
- Comunicación entre dos programas.
- Programadores pueden crear nuevos protocolos.

* Glosario
- *Paquete*, En una red informática es el bloque de datos en la comunicación entre dos extremos.
- *ISP*, proveedores de servicios de internet.
- *Puntos de peering*, puntos de intercambio directo entre dos o más redes independientes.
- *conmutador*, conmuta conexiones entre dispositivos de una misma red.
- *enrutador*, conecta redes diferentes y decide por donde van los datos.
- *modem*, Convierte señales.
- *TLS*, Saltos de enrutamiento máximos.
- *SSID*, nombre de una red inalámbrica.
- *RTT*, Round-Trip time, tiempo de envío de un paquete y llegada del ACK (TCP).
      - $RTT_M$,
      - $RTT_S$,
      - *Desviación RTT*, Calculo de la desviación RTT
- *RTO*, tiempo de retransmisión, se basa en el RTT suavizado y su desviación.
- *Señal Portadora*, Señal base entre el emisor y el receptor.
  La iformación digital se modula sobre esta señal.
- *Señal en Quadratura*, se tienen dos señales una en fase y la otra desfasada $\pi / 2$ aproximadamente.
      - Las dos señales actuan como señales portadoras independientes a la hora de modularlas.
      - Al combinar (sumar) las dos señales se crean 4 señales diferentes ($2^2$).
      - Se utiliza para mandar más bits en menos tiempo usando dos señales.
- *Protocolo sin conexión*, los paquetes se mandan de un nodo a otro sin relación entre ellas.
- *Protocolo orientado a conexión*, Se establece una conexión lógica entre los nodos,
  después se transmiten las tramas, que tienen alguna relación entre ellas.
- *FSM*, máquina de estados finita.
- *CRC*, cyclic redundancy check, se suele poner al final. Se calcula a partir del mensaje.
- *ACK*, acuse de recibo.
- *NAK*, mensaje de negación.
- *SONET*, Red óptica sincronizada.
- *OFDM*, Multiplexación por división de frecuencias ortogonal.

** Unidades
- Periodo y frecuencia
  | Periodo               |             | Frecuencia       |             |
  | Unidad                | Equivalente | Unidad           | Equivalente |
  |-----------------------+-------------+------------------+-------------|
  | Segundos (s)          | 1 s         | Herzio (Hz)      | 1 Hz        |
  | Milisegundos (ms)     | 10^{-3} s   | Kiloherzio (kHz) | 10^{3} Hz   |
  | Microsegundos (\mu s) | 10^{-6} s   | Megaherzio (MHz) | 10^{6} Hz   |
  | Nanosegundos (ns)     | 10^{-9} s   | Gigaherzio (GHz) | 10^{9} Hz   |
  | Picosegundos (ps)     | 10^{-12} s  | Teraherzio (THz) | 10^{12} Hz  |

* Recursos
- Link a los recursos del texto base.
   [[https://highered.mheducation.com/sites/0073376221/student_view0/chapter1/]]
      - 7 libro -> 9 web
      - 8 libro -> 11 web   
      - 9 libro -> 12 web
